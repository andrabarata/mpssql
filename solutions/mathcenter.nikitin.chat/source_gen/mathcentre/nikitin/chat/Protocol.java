package mathcentre.nikitin.chat;

/*Generated by MPS */


public class Protocol {
  public static final int WAITING = 0;
  public static final int AUTENTIFICATED = 1;

  private int state = WAITING;
  private String name = null;

  public Protocol() {
  }

  public String processInput(String input, String suffix) {
    String output = null;
    if (this.state == WAITING) {
      if (input == null) {
        output = Const.authReq;
      } else
      {
        if (Server.addClientName(input, suffix)) {
          output = "\u043f\u0440\u0435\u0432\u0435\u0434!";
          this.name = input;
          this.state = AUTENTIFICATED;
        } else
        {
          this.name = "\u0424\u0430\u043b\u044c\u0448\u0438\u0432\u044b\u0439 " + input;
          output = "\u043d\u0430\u0434\u043e \u0431\u044b \u043f\u0435\u0440\u0435\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u0442\u044c\u0441\u044f!";
        }
      }
    } else if (this.state == AUTENTIFICATED) {
      output = input;
    }
    return output;
  }

  public String getName() {
    return this.name;
  }

  public void onExit() {
    Server.remClientName(this.name);
  }

}
